<div *ngIf="bequest" class="bequest">
  <h4>
    {{bequest.name}}
  </h4>
  Bequest created in {{bequest.dateCreated}}
  <h6>Description</h6>
  <p>{{bequest.desc}}</p>
  
  <!-- show bequest holdings -->
  <div *ngIf="holdings">
    <ul>
      <li *ngFor="let holding of holdings">
        <app-holding [holding]="holding" [viewType]="'bequest'"
        (updated)="getHoldings()"></app-holding>
      </li>
    </ul>
  </div>
  <a [routerLink]="" (click)="onCreateHolding()"><span>&#43;</span> Add holding</a>
  <!-- new holding editor -->
  <div class="holdingEditor" *ngIf="creatingHolding">
    <h4>Creating new holding</h4>
    <form class="" (ngSubmit)="onSubmitCreateHolding()" #holdingForm="ngForm">
      <div *ngIf="people">
        <label for="person">Person
          <select class="form-control" name="person"
          required [(ngModel)]="newHolding.personID" #p="ngModel">
            <option *ngFor="let p of people" [value]="p.personID">
              {{p.firstname}} {{p.lastname}} ({{p.gradYear}})
            </option>
          </select>
        </label>
        <div *ngIf="(p.invalid) && (p.dirty || p.touched)"
            class="alert alert-danger">
          <div *ngIf="p.errors.required">
            Person must be selected.
          </div>
        </div>
      </div>
      
      <div *ngIf="bequests">
        <label for="bequest">Bequest
          <select class="form-control" name="bequest"
          required [(ngModel)]="newHolding.bequestID" #b="ngModel">
            <option *ngFor="let b of bequests" [value]="b.bequestID">
              {{b.name}}, created in {{b.dateCreated}}
            </option>
          </select>
        </label>
        <div *ngIf="(b.invalid) && (b.dirty || b.touched)"
            class="alert alert-danger">
          <div *ngIf="b.errors.required">
            Bequest must be selected.
          </div>
        </div>
      </div>
      
      <label for="dateStarted">Date holding started
        <input type="date" name="dateStarted" class="form-control"
        required
        [(ngModel)]="newHolding.dateStarted" #dateStarted="ngModel">
      </label>
      <div *ngIf="(dateStarted.invalid) && (dateStarted.dirty || dateStarted.touched)"
          class="alert alert-danger">
        <div *ngIf="dateStarted.errors.required">
          Start date must be specified.
        </div>
      </div>
      
      <label for="comment">Comment
        <input type="text" name="comment" class="form-control"
        [(ngModel)]="newHolding.comment" #comment="ngModel"
        placeholder="Comment (e.g. ''Because he's slow.'')">
      </label>
      
      <button type="submit" class="btn btn-success">Submit</button>
    </form>
  </div> <!-- end new holding editor -->
  
  <!-- editing bequest -->
  <a [routerLink]="" (click)="onEdit()">Edit</a>
  <div class="bequestEditor" *ngIf="editing">
    <h4>Editing {{bequest.name}} (id#{{bequest.bequestID}})</h4>
    <form (ngSubmit)="onSubmitEdit()" #bequestForm="ngForm">
      
      <label for="name">Name
        <input class="form-control" type="text"
        required
        [(ngModel)]="editedBequest.name" name="name"
        #name="ngModel"
        placeholder="Bequest name">
      </label>
      <div *ngIf="name.invalid && (name.dirty || name.touched)"
          class="alert alert-danger">
        <div *ngIf="name.errors.required">
          Name is required.
        </div>
      </div>
      
      <label for="desc">Description
        <textarea class="form-control" name="desc" rows="8" cols="80"
        [(ngModel)]="editedBequest.desc">
        </textarea>
      </label>
      
      <label for="dateCreated">Date created
        <input class="form-control" type="date"
        required name="dateCreated"
        [(ngModel)]="editedBequest.dateCreated" #date="ngModel">
      </label>
      <div class="alert alert-danger"
      *ngIf="date.invalid && (date.dirty || date.touched)">
        <div *ngIf="date.errors.required">
          Date is required.
        </div>
        <div *ngIf="date.errors.min">
          Date is before 1950, I doubt that's accurate...
        </div>
      </div>
      <br>
      <button type="submit" class="btn btn-success">Submit</button>
    </form>
  </div>
  
</div>
